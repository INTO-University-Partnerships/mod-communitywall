!function e(t,n,o){function i(c,a){if(!n[c]){if(!t[c]){var l="function"==typeof require&&require;if(!a&&l)return l(c,!0);if(r)return r(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){var n=t[c][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<o.length;c++)i(o[c]);return i}({1:[function(e,t,n){"use strict";var o=angular.module("wallsApp",["wallsApp.controllers","wallsApp.services","wallsApp.directives","ngSanitize","ngDragDrop"]);o.constant("CONFIG",window.CONFIG),delete window.CONFIG},{}],2:[function(e,t,n){"use strict";e("./angular-app"),e("./controllers"),e("./directives"),e("./services")},{"./angular-app":1,"./controllers":3,"./directives":4,"./services":5}],3:[function(e,t,n){"use strict";var o=angular.module("wallsApp.controllers",[]);o.controller("wallsCtrl",["$scope","$timeout","$window","wallsSrv","CONFIG",function(e,t,n,o,i){e.walls=[],e.total=-1,e.perPage=5,e.currentPage=0,e.baseurl=i.baseurl,e.canManage=i.canManage,e.closed=i.closed,e.isGuest=i.isGuest,e.timeoutPromise=null,e.prevPage=function(){e.currentPage>0&&--e.currentPage},e.prevPageDisabled=function(){return 0===e.currentPage?"disabled":""},e.nextPage=function(){e.currentPage<e.pageCount()-1&&e.currentPage++},e.nextPageDisabled=function(){return e.currentPage===e.pageCount()-1?"disabled":""},e.pageCount=function(){return 0===e.total?1:Math.ceil(e.total/e.perPage)},e.getPageOfWalls=function(n){t.cancel(e.timeoutPromise),o.getPageOfWalls(n,e.perPage).then(function(n){e.walls=n.walls,e.total=n.total,e.timeoutPromise=t(function(){e.getPageOfWalls(e.currentPage)},1e4)})},e.$watch("currentPage",function(t){e.getPageOfWalls(t)}),e.addWall=function(){n.location.href=i.baseurl+"/"+i.instanceid+"/add"},e.editWall=function(e){n.location.href=i.baseurl+"/"+i.instanceid+"/edit/"+e},e.deleteWall=function(t){n.confirm("Are you sure?")&&o.deleteWall(t).then(function(){e.currentPage>0&&(e.total-1)%e.perPage===0&&--e.currentPage,e.getPageOfWalls(e.currentPage)})}}]),o.controller("notesCtrl",["$scope","$timeout","$window","notesSrv","CONFIG",function(e,t,n,o,i){e.notes=null,e.total=null,e.baseurl=i.baseurl,e.canManage=i.canManage,e.isGuest=i.isGuest,e.timeoutPromise=null,e.editingId=null,e.addingNote=!1,e.startEditing=function(n){e.editingId=n.id,t.cancel(e.timeoutPromise)},e.stopEditing=function(){e.editingId=null,e.timeoutPromise=t(e.getNotes,1e4)},e.$on("startDragging",function(){t.cancel(e.timeoutPromise)}),e.getNotes=function(){t.cancel(e.timeoutPromise),o.getNotes().then(function(n){e.notes=n.notes,e.total=n.total,e.timeoutPromise=t(e.getNotes,1e4)})},e.postNote=function(t){e.note="",e.addingNote=!1,o.postNote(t).then(function(){e.getNotes()})},e.putNote=function(t,n){e.editingId=null,o.putNote(t,n)["finally"](function(){e.getNotes()})},e.deleteNote=function(t){n.confirm("Are you sure you want to delete this note?")&&o.deleteNote(t)["finally"](function(){e.getNotes()})},e.backToCommunityWalls=function(){n.location.href=i.baseurl+"/"+i.instanceid},e.getNotes()}])},{}],4:[function(e,t,n){"use strict";var o=angular.module("wallsApp.directives",[]);o.directive("wallListItem",["CONFIG",function(e){return{restrict:"E",scope:{wall:"=",baseurl:"@",canManage:"@",editT:"&",deleteT:"&"},templateUrl:e.baseurl+"/partials/wallListItem.twig"}}]),o.directive("communitywallNoteContainer",["CONFIG","$rootScope","$timeout",function(e,t,n){return{restrict:"A",link:function(e,t){e.clicks=0,e.timer=null,t.bind("click",function(t){e.clicks++,1===e.clicks&&(e.timer=n(function(){e.clicks=0},300)),2===e.clicks?(e.addingNote=!0,e.$broadcast("sendDblClickEvent",t),clearTimeout(e.timer),e.clicks=0):e.$broadcast("sendClickEvent",t),e.$digest()}),e.slideUp=!1,n(function(){t.bind("mouseover",function(){e.slideUp=!0,e.$digest()})},2e3)}}}]),o.directive("addNote",["CONFIG",function(e){return{restrict:"E",scope:{saveChanges:"&",note:"=",addingNote:"="},link:function(e,t){e.$watch(function(){return t.is(":visible")},function(){e.note="",t.find("textarea")[0].focus()}),e.$on("sendDblClickEvent",function(n,o){e.xcoord=o.originalEvent.pageX,e.ycoord=o.originalEvent.pageY,"undefined"==typeof e.xcoord&&"undefined"==typeof e.ycoord&&(e.xcoord=o.clientX,e.ycoord=o.clientY),e.xcoord-=t.closest(".communitywall-note-container").offset().left+12,e.ycoord-=t.closest(".communitywall-note-container").offset().top+12,t.css({top:e.ycoord+"px",left:e.xcoord+"px"})}),e.$on("sendClickEvent",function(){e.addingNote!==!1&&(0!==e.note.length&&e.saveChanges({note:e.note,xcoord:e.xcoord,ycoord:e.ycoord}),e.addingNote=!1,e.$digest())})},templateUrl:e.baseurl+"/partials/addNote.twig"}}]),o.directive("viewNote",["CONFIG","$timeout","$rootScope",function(e,t,n){return{restrict:"E",scope:{canManage:"=",dragging:"=",isEditing:"=",startEditing:"&",stopEditing:"&",saveChanges:"&",deleteNote:"&",note:"=",ngTitle:"="},link:function(e,o){e.clicks=0,e.timer=null,e.tempNote=angular.copy(e.note),o.attr("title",e.ngTitle),o.css({top:e.note.ycoord+"px",left:e.note.xcoord+"px",zIndex:e.note.id}),e.$watch("isEditing",function(e){e&&t(function(){var e=o.find("textarea"),t=e.val().length;e[0].focus(),e[0].setSelectionRange(t,t)},1)}),e.$on("sendClickEvent",function(){if(e.isEditing===!0){if(angular.equals(e.tempNote,e.note))return e.stopEditing();e.saveChanges({id:e.note.id,note:e.note.note,xcoord:e.note.xcoord,ycoord:e.note.ycoord})}}),o.bind("click",function(n){e.clicks++,1===e.clicks&&(e.timer=t(function(){e.clicks=0},300)),2===e.clicks&&(e.note.is_owner||e.canManage)&&(clearTimeout(e.timer),e.clicks=0,e.startEditing(),e.$digest()),n.stopPropagation()}),o.bind("dragstart",function(t){return e.isEditing===!0?t.preventDefault():void n.$broadcast("startDragging")}).bind("dragstop",function(){e.note.xcoord=angular.element(o).position().left||0,e.note.ycoord=angular.element(o).position().top||0,e.saveChanges({id:e.note.id,note:e.note.note,xcoord:e.note.xcoord,ycoord:e.note.ycoord})})},templateUrl:e.baseurl+"/partials/viewNote.twig"}}])},{}],5:[function(e,t,n){"use strict";var o=angular.module("wallsApp.services",[]);o.service("wallsSrv",["$http","$q","CONFIG",function(e,t,n){var o=n.baseurl+n.api+"/wall/"+n.instanceid;this.getPageOfWalls=function(n,i){var r=t.defer();return e.get(o+"?limitfrom="+n*i+"&limitnum="+i).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},this.deleteWall=function(n){var i=t.defer();return e["delete"](o+"/"+n).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}]),o.service("notesSrv",["$http","$q","CONFIG",function(e,t,n){var o=n.baseurl+n.api+"/wall/"+n.instanceid+"/"+n.wallid+"/note";this.getNotes=function(){var n=t.defer();return e.get(o).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.postNote=function(n){var i=t.defer();return e.post(o,n).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},this.putNote=function(n,i){var r=t.defer();return e.put(o+"/"+n,i).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},this.deleteNote=function(n){var i=t.defer();return e["delete"](o+"/"+n).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}])},{}]},{},[2]);